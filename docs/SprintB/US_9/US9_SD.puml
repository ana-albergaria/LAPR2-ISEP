@startuml
autonumber
'hide footbox
actor "Administrator" as ADM

participant ":CreateTestTypeUI  " as UI
participant ":CreateTestTypeController" as CTRL
participant ":Company" as PLAT
participant "store:ParameterCategory" as TEST_TYPE_STORE
/'participant ":Platform" as PLAT'/
participant "store:TestTypeStore" as ORG
participant "tt\n:TestType" as TAREFA


activate ADM
ADM -> UI : asks to specify a new test type
activate UI
UI --> ADM : requests data (code, description, collectingMethod)
deactivate UI

ADM -> UI : types requested data
activate UI

UI -> CTRL : categoriesList = getCategoriesList()
activate CTRL

CTRL -> PLAT : store = getParameterCategoriyStore()
activate PLAT
|||
deactivate PLAT

CTRL -> TEST_TYPE_STORE : categoriesList = getCategoriesList()
activate TEST_TYPE_STORE
|||
deactivate TEST_TYPE_STORE
deactivate CTRL

UI --> ADM : shows types of test list and asks to select at least one
deactivate PLAT
deactivate UI

ADM -> UI : selects type(s) of test
activate UI

UI -> CTRL : createTestType(code, description, collectingMethod, selectedCategoriesCodes)
activate CTRL

CTRL -> PLAT : categoriesStore = getCategoriesList()
activate PLAT
|||
deactivate PLAT

loop For each selected categorie code
CTRL -> TEST_TYPE_STORE : selectedCategoriesList = getCategoriesByCode(selectedCategoriesCodes)
activate TEST_TYPE_STORE
|||
deactivate TEST_TYPE_STORE
end

CTRL -> PLAT : TestTypeStore = getParameterCategoriyStore()
activate PLAT
|||
deactivate PLAT
CTRL -> ORG: testType = createTestType(code, description, collectingMethod, selectedCategoriesList)
activate ORG

ORG --> TAREFA**: create(code, description, collectingMethod, selectedCategoriesList)
deactivate ORG
CTRL -> ORG: validateTestType(testType)
activate ORG
CTRL --> UI: result

UI --> ADM: shows all data and requests confirmation
deactivate ORG
deactivate PLAT
deactivate CTRL
deactivate UI

ADM -> UI : confirms the data
activate UI
UI -> CTRL : saveTestType()
activate CTRL

CTRL -> ORG : saveTestType(testType)
activate ORG

ORG -> ORG: validateTestType(testType)
ORG -> ORG: addTestType(testType)

CTRL --> UI: result

UI --> ADM : informs operation success
deactivate ORG
deactivate CTRL
deactivate UI

deactivate ADM

@enduml
